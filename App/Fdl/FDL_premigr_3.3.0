#!/bin/bash

set -e

if [ -z "$wpub" ]; then
    echo "Undefined or empty wpub environment variable!"
    exit 1
fi

if [ -z "$pgservice_core" ]; then
    echo "Undefined or empty pgservice_core!"
    exit 1
fi




"$wpub"/wsh.php --api=generateDocumentClass

rm -f "$wpub"/FDLGEN/Class.Doc[1-9]*.php
rm -f "$wpub"/FDLGEN/Class.Attrid[1-9]*.php

PGSERVICE="$pgservice_core" psql --set ON_ERROR_STOP=on -f - << SQL

SQL
RET=$?
if [ $RET -ne 0 ]; then
    echo "Error ."
    exit $RET
fi

exit 0
